<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Wedm_ Phigros Dashboard</title>
    <style>
        /* =========================================
           Phigros 风格核心变量
           ========================================= */
        :root {
            --bg-color: #050505;        /* 极黑背景 */
            --card-dim: rgba(255, 255, 255, 0.05); /* 未选中卡片背景 */
            --card-active: rgba(255, 255, 255, 0.95); /* 选中卡片背景 (高亮) */
            --text-dim: #888;
            --text-active: #000;        /* 选中时文字反黑 */
            --accent-cyan: #00EAFF;     /* 科技蓝 (装饰线) */
            --accent-yellow: #FFE600;   /* 警告黄 (装饰线) */
            --skew-deg: -15deg;         /* 核心斜角 */
            --skew-fix: 15deg;          /* 文字反斜 */
        }

        body {
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
            font-family: "Exo 2", "Eurostile", -apple-system, sans-serif; /* 科技字体优先 */
            overflow: hidden; /* 禁止 Body 滚动，只允许列表滚动 */
            color: white;
            height: 100vh;
            width: 100vw;
        }

        /* 背景装饰线 (模拟 Phigros 背景) */
        .bg-decoration {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: 
                linear-gradient(45deg, transparent 40%, rgba(0, 234, 255, 0.05) 45%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 234, 255, 0.1), transparent 40%);
            z-index: -1;
            pointer-events: none;
        }

        /* =========================================
           左上角：总分展示 (Total Ranking)
           ========================================= */
        .header-score {
            position: fixed;
            top: 30px;
            left: 20px;
            z-index: 10;
        }
        
        .header-label {
            font-size: 0.8rem;
            color: var(--accent-cyan);
            letter-spacing: 2px;
            text-transform: uppercase;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(0, 234, 255, 0.5);
        }

        .header-value {
            font-size: 3.5rem;
            font-weight: 900;
            font-style: italic; /* 斜体数字 */
            line-height: 1;
            margin-left: -5px;
        }

        /* =========================================
           核心交互区：滚动列表
           ========================================= */
        .scroll-container {
            height: 100vh;
            overflow-y: scroll;
            scroll-behavior: smooth;
            /* 隐藏滚动条 */
            scrollbar-width: none; 
            padding-top: 40vh;    /* 留白，让第一项能滚到中间 */
            padding-bottom: 40vh; /* 留白，让最后一项能滚到中间 */
            
            /* CSS Snap: 模拟选曲吸附感 */
            scroll-snap-type: y mandatory; 
        }
        .scroll-container::-webkit-scrollbar {
            display: none;
        }

        /* 列表项容器 */
        .list-item-wrapper {
            /* 布局定位 */
            width: 85%;
            margin-left: auto; /* 靠右布局，类似 Phigros 选曲 */
            margin-right: 0;   /* 贴右边 */
            height: 90px;      /* 单个卡片高度 */
            margin-bottom: 25px;
            
            display: flex;
            align-items: center;
            justify-content: flex-end; /* 内容靠右 */
            
            /* Snap 对齐点 */
            scroll-snap-align: center;
            
            perspective: 1000px; /* 3D 效果准备 */
        }

        /* 平行四边形卡片 */
        .phi-card {
            width: 100%;
            height: 100%;
            background: var(--card-dim);
            transform: skewX(var(--skew-deg)); /* 斜切 */
            border-left: 4px solid #333; /* 默认左边框 */
            
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px 0 40px;
            
            transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1); /* 弹性动画 */
            position: relative;
            
            /* 玻璃质感 */
            backdrop-filter: blur(5px);
            box-shadow: 10px 10px 20px rgba(0,0,0,0.5);
        }

        /* 选中状态 (Active) - JS 控制 */
        .list-item-wrapper.active .phi-card {
            background: var(--card-active); /* 变白 */
            transform: skewX(var(--skew-deg)) scale(1.05) translateX(-20px); /* 放大并向左突进 */
            border-left: 8px solid var(--accent-cyan); /* 亮蓝边框 */
            box-shadow: 
                0 0 30px rgba(0, 234, 255, 0.4),
                inset 0 0 20px rgba(255, 255, 255, 0.8);
            z-index: 2;
        }

        /* 板块分割线 (Section Header) */
        .section-separator {
            height: 40px;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            margin-bottom: 20px;
            padding-right: 20px;
            scroll-snap-align: start;
        }
        
        .section-line {
            height: 2px;
            width: 50%;
            background: linear-gradient(to left, var(--accent-yellow), transparent);
            transform: skewX(var(--skew-deg));
        }
        
        .section-text {
            color: var(--accent-yellow);
            font-size: 1rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-left: 10px;
            font-style: italic;
            text-shadow: 0 0 10px rgba(255, 230, 0, 0.5);
        }

        /* =========================================
           内容排版 (反斜)
           ========================================= */
        /* 为了防止文字歪斜，内部再反向 skew */
        .phi-content {
            transform: skewX(var(--skew-fix));
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* 左侧：信息层叠 */
        .info-group {
            display: flex;
            flex-direction: column;
        }

        .item-name {
            font-size: 1.4rem;
            font-weight: 800;
            color: #fff;
            margin-bottom: 4px;
            transition: color 0.2s;
        }

        .item-formula {
            font-size: 0.7rem;
            color: #666;
            font-family: monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* 选中时文字颜色翻转 */
        .list-item-wrapper.active .item-name { color: #000; }
        .list-item-wrapper.active .item-formula { color: #444; font-weight: bold; }

        /* 右侧：分数展示 */
        .score-group {
            text-align: right;
        }

        .item-score {
            font-size: 2rem;
            font-weight: 900;
            color: #fff;
            font-style: italic;
        }
        
        /* 选中时分数颜色 */
        .list-item-wrapper.active .item-score {
            color: #000;
            text-shadow: 0 0 0; /* 移除阴影保持清晰 */
        }
        
        .rank-badge {
            font-size: 0.7rem;
            background: #333;
            padding: 2px 6px;
            border-radius: 2px;
            margin-left: 5px;
            vertical-align: middle;
            transform: skewX(-10deg);
            display: inline-block;
        }
        
        .list-item-wrapper.active .rank-badge {
            background: var(--accent-cyan);
            color: #000;
        }

        /* 遮罩层 (上下渐变遮罩) */
        .vignette {
            position: fixed;
            left: 0; right: 0;
            height: 15vh;
            z-index: 5;
            pointer-events: none;
        }
        .v-top { top: 0; background: linear-gradient(to bottom, black, transparent); }
        .v-bottom { bottom: 0; background: linear-gradient(to top, black, transparent); }

    </style>
</head>
<body>

    <div class="bg-decoration"></div>
    <div class="vignette v-top"></div>
    <div class="vignette v-bottom"></div>

    <div class="header-score">
        <div class="header-label">Total Efficiency</div>
        <div id="grand-total" class="header-value">0.00</div>
    </div>

    <div class="scroll-container" id="scroll-track">
        </div>

    <script>
        // ========================================================
        // 1. 数据配置 (逻辑完全保留)
        // ========================================================
        const data = {
            work: {
                title: "Chapter A: Work",
                method: "sum", 
                items: [
                    { name: "Current Output", formula: "No Data", value: 0 }
                ]
            },
            
            growth: {
                title: "Chapter B: Growth",
                method: "multiply", 
                subSections: [
                    {
                        title: "System 1: Reading",
                        items: [
                            { name: "Read Speed", formula: "WPM", value: 1 },
                            { name: "Undst Rate", formula: "%", value: 1 },
                            { name: "Duration", formula: "Hours", value: 1 },
                            { name: "Output Ratio", formula: "Out/In", value: 1 },
                            { name: "Filter", formula: "Signal/Noise", value: 1 }
                        ]
                    },
                    {
                        title: "System 2: Value",
                        items: [
                            { name: "Self Explore", formula: "Clarity", value: 1 },
                            { name: "Values Iter", formula: "Update", value: 1 },
                            { name: "Goal Split", formula: "Granularity", value: 1 },
                            { name: "Timing", formula: "Freq", value: 1 },
                            { name: "Logic Self", formula: "Consistency", value: 1 },
                            { name: "Execution", formula: "Action", value: 1 },
                            { name: "Review", formula: "Feedback", value: 1 },
                            { name: "Reverse Eng", formula: "Causality", value: 1 },
                            { name: "Accumulation", formula: "Compound", value: 1 },
                            { name: "Endurance", formula: "Long-term", value: 1 }
                        ]
                    },
                    {
                        title: "System 3: Mindset",
                        items: [
                            { name: "Personality", formula: "Optimize", value: 1 },
                            { name: "Neurons", formula: "Links", value: 1 },
                            { name: "Attention", formula: "Resource", value: 1 },
                            { name: "Motivation", formula: "Meta-Cog", value: 1 },
                            { name: "Producer View", formula: "Supply/Demand", value: 1 },
                            { name: "Exchange", formula: "Non-Zero", value: 1 },
                            { name: "Confidence", formula: "Successes", value: 1 },
                            { name: "No Labels", formula: "Fluidity", value: 1 },
                            { name: "Influence", formula: "Radius", value: 1 },
                            { name: "Risk Test", formula: "Control", value: 1 },
                            { name: "Hope", formula: "Resilience", value: 1 },
                            { name: "Future Live", formula: "Vision", value: 1 }
                        ]
                    },
                    {
                        title: "System 4: University",
                        items: [
                            { name: "Respect Diff", formula: "Tolerance", value: 1 },
                            { name: "Cooperation", formula: "Synergy", value: 1 },
                            { name: "Resource Mind", formula: "Leverage", value: 1 },
                            { name: "Breakthrough", formula: "Strength", value: 1 },
                            { name: "Networking", formula: "Upward", value: 1 },
                            { name: "Environment", formula: "Field", value: 1 },
                            { name: "Circle Select", formula: "Filter", value: 1 },
                            { name: "Circle Join", formula: "Integration", value: 1 },
                            { name: "Ask Help", formula: "Query", value: 1 }
                        ]
                    }
                ]
            },

            wealth: {
                title: "Chapter C: Wealth",
                method: "sum",
                items: [
                    { name: "Baseline", formula: "Initial", value: 1 }
                ]
            }
        };

        // ========================================================
        // 2. 渲染引擎 (Phigros 风格适配)
        // ========================================================
        
        function calculateItems(items, method) {
            if (!items || items.length === 0) return method === 'multiply' ? 1 : 0;
            let total = method === 'multiply' ? 1 : 0;
            items.forEach(item => {
                if (method === 'multiply') total *= item.value;
                else total += item.value;
            });
            return total;
        }

        function renderPhigrosDashboard() {
            const track = document.getElementById('scroll-track');
            let grandTotal = 0;
            let htmlBuffer = '';

            // 遍历大板块
            for (const key in data) {
                const section = data[key];
                let sectionTotal = 0;

                // 插入大板块分割线
                htmlBuffer += `
                    <div class="section-separator">
                        <div class="section-line"></div>
                        <div class="section-text">${section.title}</div>
                    </div>
                `;

                if (section.subSections) {
                    // 嵌套模式
                    sectionTotal = section.method === 'multiply' ? 1 : 0;
                    
                    section.subSections.forEach(sub => {
                        const subTotal = calculateItems(sub.items, section.method);
                        if (section.method === 'multiply') sectionTotal *= subTotal;
                        else sectionTotal += subTotal;

                        // 插入子板块小标题 (作为不可选中的装饰条)
                        htmlBuffer += `
                            <div class="section-separator" style="margin-bottom:10px; opacity:0.6;">
                                <div class="section-line" style="background: linear-gradient(to left, #fff, transparent); width:30%;"></div>
                                <div class="section-text" style="color:#fff; font-size:0.8rem;">${sub.title}</div>
                            </div>
                        `;

                        // 渲染子板块内的条目
                        sub.items.forEach(item => {
                            htmlBuffer += createCardHTML(item);
                        });
                    });
                } else {
                    // 扁平模式
                    sectionTotal = calculateItems(section.items, section.method);
                    section.items.forEach(item => {
                        htmlBuffer += createCardHTML(item);
                    });
                }

                grandTotal += sectionTotal;
            }

            track.innerHTML = htmlBuffer;
            document.getElementById('grand-total').innerText = grandTotal.toFixed(2);
            
            // 启动高亮监听
            initObserver();
        }

        // 生成单张卡片的 HTML
        function createCardHTML(item) {
            return `
                <div class="list-item-wrapper">
                    <div class="phi-card">
                        <div class="phi-content">
                            <div class="info-group">
                                <div class="item-name">${item.name}</div>
                                <div class="item-formula">${item.formula || 'FORMULA'}</div>
                            </div>
                            <div class="score-group">
                                <span class="item-score">${item.value}</span>
                                <span class="rank-badge">IV</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ========================================================
        // 3. 核心交互：Intersection Observer (高亮逻辑)
        // ========================================================
        function initObserver() {
            const options = {
                root: document.querySelector('.scroll-container'),
                rootMargin: '-45% 0px -45% 0px', // 核心！只关注屏幕中间 10% 的区域
                threshold: 0
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('active');
                    } else {
                        entry.target.classList.remove('active');
                    }
                });
            }, options);

            // 监听所有卡片
            document.querySelectorAll('.list-item-wrapper').forEach(card => {
                observer.observe(card);
            });
        }

        // 启动
        renderPhigrosDashboard();
    </script>
</body>
</html>